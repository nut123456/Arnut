# -*- coding: utf-8 -*-
"""
Created on Tue Apr 11 16:29:32 2023

@author: อาณัติ
"""

import numpy as np
import math
import matplotlib.pyplot as plt
import time
start = time.time()

#%% Truss structure analysis
# ASSEMBLED GLOBAL STIFFNESS MATRIX AND PERFORM OPTIMIZATION USING CLPSO
def Dome1410_Stiffness(x):              #ทำให้เหลือแค่ A ก็พอ
    xx=[0]*(1409-17)
    xx[47:93]=x[0:46]
    xx[94:140]=x[0:46]
    xx[141:187]=x[0:46]
    xx[188:234]=x[0:46]
    xx[235:281]=x[0:46]
    xx[282:228]=x[0:46]
    xx[329:375]=x[0:46]
    xx[376:422]=x[0:46]
    xx[423:469]=x[0:46]
    xx[470:516]=x[0:46]
    xx[517:563]=x[0:46]
    xx[564:612]=x[0:46]
    xx[611:657]=x[0:46]
    xx[658:704]=x[0:46]
    xx[705:751]=x[0:46]
    xx[752:798]=x[0:46]
    xx[799:845]=x[0:46]
    xx[846:892]=x[0:46]
    xx[893:939]=x[0:46]
    xx[940:986]=x[0:46]
    xx[987:1033]=x[0:46]
    xx[1034:1080]=x[0:46]
    xx[1081:1127]=x[0:46]
    xx[1128:1174]=x[0:46]
    xx[1175:1221]=x[0:46]
    xx[1222:1268]=x[0:46]
    xx[1269:1315]=x[0:46]
    xx[1316:1362]=x[0:46]
    xx[1363:1409]=x[0:46]



    A1 =[x[0],x[1],x[2],x[3],x[4],x[5],x[7],x[8],x[9],x[10],x[11],x[12], x[13],x[14],x[15],x[16], x[17], x[18], x[19], x[20],x[21],x[22], x[23],x[24],x[25], x[26], x[27],x[28], x[2], x[30],
    xx[47],xx[94],xx[141],xx[188],xx[235],xx[329],xx[423],xx[517],xx[611],xx[705],xx[799],xx[893],xx[987],xx[1081],xx[1175],xx[1269],xx[1363],
    xx[48],xx[95],xx[142],xx[189],xx[236],xx[330],xx[424],xx[518],xx[612],xx[706],xx[800],xx[894],xx[988],xx[1082],xx[1176],xx[1270],xx[1364],
    xx[49],xx[96],xx[143],xx[190],xx[237],xx[331],xx[425],xx[519],xx[613],xx[707],xx[801],xx[895],xx[989],xx[1083],xx[1177],xx[1271],xx[1365],
    xx[50],xx[97],xx[144],xx[191],xx[238],xx[332],xx[426],xx[520],xx[614],xx[708],xx[802],xx[896],xx[990],xx[1084],xx[1178],xx[1272],xx[1366],
    xx[51],xx[98],xx[145],xx[192],xx[239],xx[333],xx[427],xx[521],xx[615],xx[709],xx[803],xx[897],xx[991],xx[1085],xx[1179],xx[1273],xx[1367],
    xx[52],xx[99],xx[146],xx[193],xx[240],xx[334],xx[428],xx[522],xx[616],xx[710],xx[804],xx[898],xx[992],xx[1086],xx[1180],xx[1274],xx[1368],
    xx[53],xx[100],xx[147],xx[194],xx[241],xx[335],xx[429],xx[523],xx[617],xx[711],xx[805],xx[899],xx[993],xx[1087],xx[1181],xx[1275],xx[1369],
    xx[54],xx[101],xx[148],xx[195],xx[242],xx[336],xx[430],xx[524],xx[618],xx[712],xx[806],xx[900],xx[994],xx[1088],xx[1182],xx[1276],xx[1370],
    xx[55],xx[102],xx[149],xx[196],xx[243],xx[337],xx[431],xx[525],xx[619],xx[713],xx[807],xx[901],xx[995],xx[1089],xx[1183],xx[1277],xx[1371],
    xx[56],xx[103],xx[150],xx[197],xx[244],xx[338],xx[432],xx[526],xx[620],xx[714],xx[808],xx[902],xx[996],xx[1090],xx[1184],xx[1278],xx[1372],
    xx[57],xx[104],xx[151],xx[198],xx[245],xx[339],xx[433],xx[527],xx[621],xx[715],xx[809],xx[903],xx[997],xx[1091],xx[1185],xx[1279],xx[1373],
    xx[58],xx[105],xx[152],xx[199],xx[246],xx[340],xx[434],xx[528],xx[622],xx[716],xx[810],xx[904],xx[998],xx[1092],xx[1186],xx[1280],xx[1374],
    xx[59],xx[106],xx[153],xx[200],xx[247],xx[341],xx[435],xx[529],xx[623],xx[717],xx[811],xx[905],xx[999],xx[1093],xx[1187],xx[1281],xx[1375],
    xx[60],xx[107],xx[154],xx[201],xx[248],xx[342],xx[436],xx[530],xx[624],xx[718],xx[812],xx[906],xx[1000],xx[1094],xx[1188],xx[1282],xx[1376],
    xx[61],xx[108],xx[155],xx[202],xx[249],xx[343],xx[437],xx[531],xx[625],xx[719],xx[813],xx[907],xx[1001],xx[1095],xx[1189],xx[1283],xx[1377],
    xx[62],xx[109],xx[156],xx[203],xx[250],xx[344],xx[438],xx[532],xx[626],xx[720],xx[814],xx[908],xx[1002],xx[1096],xx[1190],xx[1284],xx[1378],
    xx[63],xx[110],xx[157],xx[204],xx[251],xx[345],xx[439],xx[533],xx[627],xx[721],xx[815],xx[909],xx[1003],xx[1097],xx[1191],xx[1285],xx[1379],
    xx[64],xx[111],xx[158],xx[205],xx[252],xx[346],xx[440],xx[534],xx[628],xx[722],xx[816],xx[910],xx[1004],xx[1098],xx[1192],xx[1286],xx[1380],
    xx[65],xx[112],xx[159],xx[206],xx[253],xx[347],xx[441],xx[535],xx[629],xx[723],xx[817],xx[911],xx[1005],xx[1099],xx[1193],xx[1287],xx[1381],
    xx[66],xx[113],xx[160],xx[207],xx[254],xx[348],xx[442],xx[536],xx[630],xx[724],xx[818],xx[912],xx[1006],xx[1100],xx[1194],xx[1288],xx[1382],
    xx[67],xx[114],xx[161],xx[208],xx[255],xx[349],xx[443],xx[537],xx[631],xx[725],xx[819],xx[913],xx[1007],xx[1101],xx[1195],xx[1289],xx[1383],
    xx[68],xx[115],xx[162],xx[209],xx[256],xx[350],xx[444],xx[538],xx[632],xx[726],xx[820],xx[914],xx[1008],xx[1102],xx[1196],xx[1290],xx[1384],
    xx[69],xx[116],xx[163],xx[210],xx[257],xx[351],xx[445],xx[539],xx[633],xx[727],xx[821],xx[915],xx[1009],xx[1103],xx[1197],xx[1291],xx[1385],
    xx[70],xx[117],xx[164],xx[211],xx[258],xx[352],xx[446],xx[540],xx[634],xx[728],xx[822],xx[916],xx[1010],xx[1104],xx[1198],xx[1292],xx[1386],
    xx[71],xx[118],xx[165],xx[212],xx[259],xx[353],xx[447],xx[541],xx[635],xx[729],xx[823],xx[917],xx[1011],xx[1105],xx[1199],xx[1293],xx[1387],
    xx[72],xx[119],xx[166],xx[213],xx[260],xx[354],xx[448],xx[542],xx[636],xx[730],xx[824],xx[918],xx[1012],xx[1106],xx[1200],xx[1294],xx[1388],
    xx[73],xx[120],xx[167],xx[214],xx[261],xx[355],xx[449],xx[543],xx[637],xx[731],xx[825],xx[919],xx[1013],xx[1107],xx[1201],xx[1295],xx[1389],
    xx[74],xx[121],xx[168],xx[215],xx[262],xx[356],xx[450],xx[544],xx[638],xx[732],xx[826],xx[920],xx[1014],xx[1108],xx[1202],xx[1296],xx[1390],
    xx[75],xx[122],xx[169],xx[216],xx[263],xx[357],xx[451],xx[545],xx[639],xx[733],xx[827],xx[921],xx[1015],xx[1109],xx[1203],xx[1297],xx[1391],
    xx[76],xx[123],xx[170],xx[217],xx[264],xx[358],xx[452],xx[546],xx[640],xx[734],xx[828],xx[922],xx[1016],xx[1110],xx[1204],xx[1298],xx[1392],
    xx[77],xx[124],xx[171],xx[218],xx[265],xx[359],xx[453],xx[547],xx[641],xx[735],xx[829],xx[923],xx[1017],xx[1111],xx[1205],xx[1299],xx[1393],
    xx[78],xx[125],xx[172],xx[219],xx[266],xx[360],xx[454],xx[548],xx[642],xx[736],xx[830],xx[924],xx[1018],xx[1112],xx[1206],xx[1300],xx[1394],
    xx[79],xx[126],xx[173],xx[220],xx[267],xx[361],xx[455],xx[549],xx[643],xx[737],xx[831],xx[925],xx[1019],xx[1113],xx[1207],xx[1301],xx[1395],
    xx[80],xx[127],xx[174],xx[221],xx[268],xx[362],xx[456],xx[550],xx[644],xx[738],xx[832],xx[926],xx[1020],xx[1114],xx[1208],xx[1302],xx[1396],
    xx[81],xx[128],xx[175],xx[222],xx[269],xx[363],xx[457],xx[551],xx[645],xx[739],xx[833],xx[927],xx[1021],xx[1115],xx[1209],xx[1303],xx[1397],
    xx[82],xx[129],xx[176],xx[223],xx[270],xx[364],xx[458],xx[552],xx[646],xx[740],xx[834],xx[928],xx[1022],xx[1116],xx[1210],xx[1304],xx[1398],
    xx[83],xx[130],xx[177],xx[224],xx[271],xx[365],xx[459],xx[553],xx[647],xx[741],xx[835],xx[929],xx[1023],xx[1117],xx[1211],xx[1305],xx[1399],
    xx[84],xx[131],xx[178],xx[225],xx[272],xx[366],xx[460],xx[554],xx[648],xx[742],xx[836],xx[930],xx[1024],xx[1118],xx[1212],xx[1306],xx[1400],
    xx[85],xx[132],xx[179],xx[226],xx[273],xx[367],xx[461],xx[555],xx[649],xx[743],xx[837],xx[931],xx[1025],xx[1119],xx[1213],xx[1307],xx[1401],
    xx[86],xx[133],xx[180],xx[227],xx[274],xx[368],xx[462],xx[556],xx[650],xx[744],xx[838],xx[932],xx[1026],xx[1120],xx[1214],xx[1308],xx[1402],
    xx[87],xx[134],xx[181],xx[228],xx[275],xx[369],xx[463],xx[557],xx[651],xx[745],xx[839],xx[933],xx[1027],xx[1121],xx[1215],xx[1309],xx[1403],
    xx[88],xx[135],xx[182],xx[229],xx[276],xx[370],xx[464],xx[558],xx[652],xx[746],xx[840],xx[934],xx[1028],xx[1122],xx[1216],xx[1310],xx[1404],
    xx[89],xx[136],xx[183],xx[230],xx[277],xx[371],xx[465],xx[559],xx[653],xx[747],xx[841],xx[935],xx[1029],xx[1123],xx[1217],xx[1311],xx[1405],
    xx[90],xx[137],xx[184],xx[231],xx[278],xx[372],xx[466],xx[560],xx[654],xx[748],xx[842],xx[936],xx[1030],xx[1124],xx[1218],xx[1312],xx[1406],
    xx[91],xx[138],xx[185],xx[232],xx[279],xx[373],xx[467],xx[561],xx[655],xx[749],xx[843],xx[937],xx[1031],xx[1125],xx[1219],xx[1313],xx[1407],
    xx[92],xx[139],xx[186],xx[233],xx[280],xx[374],xx[468],xx[562],xx[656],xx[750],xx[844],xx[938],xx[1032],xx[1126],xx[1220],xx[1314],xx[1408],
    xx[93],xx[140],xx[187],xx[234],xx[281],xx[375],xx[469],xx[563],xx[657],xx[751],xx[845],xx[939],xx[1033],xx[1127],xx[1221],xx[1315],xx[1409]]

    #print(A1)

    ###Input:coord, connec, freenode, variables, A, No_groups
#coord
    coord=[]
    connec=[]
    # **** m unit
    coord.append([1, 0, 4])
    coord.append([3, 0, 3.75])
    coord.append([5, 0, 3.25])
    coord.append([7, 0, 2.75])
    coord.append([9, 0, 2])
    coord.append([11, 0, 1.25])
    coord.append([13, 0, 0])
    coord.append([1.989, 0.209, 3])
    coord.append([3.978, 0.418, 2.75])
    coord.append([5.967, 0.627, 2.25])
    
    coord.append([7.956, 0.836, 1.75])
    coord.append([9.945, 1.0453, 1])
    coord.append([11.934, 1.2543, -0.5])
    coord.append([0.9782, 0.2079, 4])
    coord.append([2.9344, 0.6237, 3.75])
    coord.append([4.8907, 1.0396, 3.25])
    coord.append([6.847, 1.4554 ,2.75])
    coord.append([8.8033, 1.8712, 2])
    coord.append([10.7596, 2.287, 1.25])
    coord.append([12.7159, 2.7029, 0])
    
    coord.append([1.9021, 0.618, 3])
    coord.append([3.8042, 1.2359, 2.75])
    coord.append([5.7063, 1.8539 ,2.25])
    coord.append([7.6083 ,2.4719, 1.75])
    coord.append([9.5104, 3.0901 ,1])
    coord.append([11.4124 ,3.7081, -0.5])
    coord.append([0.9136 ,0.4067, 4])
    coord.append([2.7406 ,1.2202 ,3.75])
    coord.append([4.5677 ,2.0337 ,3.25])
    coord.append([6.3948, 2.8472, 2.75])
    
    coord.append([8.2219, 3.6606 ,2])
    coord.append([10.049 ,4.4741 ,1.25])
    coord.append([11.8761 ,5.2876, 0])
    coord.append([1.732 ,0.9999, 3])
    coord.append([3.4641, 1.9999, 2.75])
    coord.append([5.1961, 2.9998 ,2.25])
    coord.append([6.9281, 3.9997, 1.75])
    coord.append([8.6601 ,4.9999, 1])
    coord.append([10.3921, 5.9999 ,-0.5])
    coord.append([0.809, 0.5878, 4])

    coord.append([2.4271, 1.7634, 3.75])
    coord.append([4.0451, 2.9389 ,3.25])
    coord.append([5.6631 ,4.1145 ,2.75])
    coord.append([7.2812 ,5.2901, 2])
    coord.append([8.8992, 6.4656, 1.25])
    coord.append([10.5172, 7.6412, 0])
    coord.append([1.4863 ,1.3382 ,3])
    coord.append([2.9726, 2.6764 ,2.75])
    coord.append([4.4589, 4.0146 ,2.25])
    coord.append([5.9452, 5.3528, 1.75])
    
    coord.append([7.4313,	6.6912, 1])
    coord.append([8.9176, 8.0294, -0.5])
    coord.append([0.6691, 0.7431, 4])
    coord.append([2.0074 ,2.2294, 3.75])
    coord.append([3.3457 ,3.7157, 3.25])
    coord.append([4.6839 ,5.2020 ,2.75])
    coord.append([6.0222, 6.6883, 2])
    coord.append([7.3604,	8.1746, 1.25])
    coord.append([8.6987, 9.6609, 0])
    coord.append([1.1756, 1.6180, 3])
    
    coord.append([2.3512, 3.2359, 2.75])
    coord.append([3.5268, 4.8539, 2.25])
    coord.append([4.7023, 6.4719,	1.75])
    coord.append([5.8777,8.09, 1])
    coord.append([7.0533, 9.708, -0.5])
    coord.append([0.5, 0.866, 4])
    coord.append([1.5, 2.5981, 3.75])
    coord.append([2.5 ,4.3301 ,3.25])
    coord.append([3.5, 6.0622 ,2.75])
    coord.append([4.5 ,7.7942 ,2])
    
    coord.append([5.5, 9.5263, 1.25])
    coord.append([6.5 ,11.2583, 0])
    coord.append([0.8135, 1.827, 3])
    coord.append([1.627 ,3.6541, 2.75])
    coord.append([2.4405, 5.4811 ,2.25])
    coord.append([3.2540, 7.3081 ,1.75])
    coord.append([4.0672, 9.1353, 1])
    coord.append([4.8807, 10.9623 ,-0.5])
    coord.append([0.309, 0.9511, 4])
    coord.append([0.9271, 2.8532 ,3.75])
    
    coord.append([1.5451, 4.7553, 3.25])
    coord.append([2.1631, 6.6574 ,2.75])
    coord.append([2.7812 ,8.5595, 2])
    coord.append([3.3992, 10.4616, 1.25])
    coord.append([4.0172, 12.3637 ,0])
    coord.append([0.4159, 1.9562, 3])
    coord.append([0.8317 ,3.9125 ,2.75])
    coord.append([1.2476, 5.8687, 2.25])
    coord.append([1.6635, 7.8249, 1.75])
    coord.append([2.079, 9.7813, 1])
    
    coord.append([2.4949 ,11.7375, -0.5])
    coord.append([0.1045 ,0.9945 ,4])
    coord.append([0.3136, 2.9836, 3.75])
    coord.append([0.5226, 4.9726, 3.25])
    coord.append([0.7317, 6.9617, 2.75])
    coord.append([0.9408, 8.9507 ,2])
    coord.append([1.1498, 10.9397, 1.25])
    coord.append([1.3589, 12.9288, 0])
    coord.append([0.0001, 3.9999, 2.75])
    coord.append([0.0002, 5.9999, 2.25])
    
    coord.append([0.0002, 7.9998 ,1.75])
    coord.append([0 ,9.9998, 1])
    coord.append([0, 11.9997 ,-0.5])
    coord.append([-0.1045, 0.9945, 4])
    coord.append([-0.3136, 2.9836, 3.75])
    coord.append([-0.5226 ,4.9726, 3.25])
    coord.append([-0.7317, 6.9617, 2.75])
    coord.append([-0.9408, 8.9507, 2])
    coord.append([-1.1498, 10.9397, 1.25])
    coord.append([-1.3589, 12.9288 ,0])
    
    coord.append([-0.4158, 1.9563 ,3])
    coord.append([-0.8315, 3.9125, 2.75])
    coord.append([-1.2473, 5.8688, 2.25])
    coord.append([-1.6631, 7.825, 1.75])
    coord.append([-2.0791, 9.7813, 1])
    coord.append([-2.4949, 11.7375 ,-0.5])
    coord.append([-0.309, 0.9511, 4])
    coord.append([-0.9271 ,2.8532, 3.75])
    coord.append([-1.5451, 4.7553, 3.25])
    coord.append([-2.1631, 6.6574, 2.75])

    coord.append([-2.7812, 8.5595, 2])
    coord.append([-3.3992 ,10.4616 ,1.25])
    coord.append([-4.0172, 12.3637, 0])
    coord.append([-0.8134, 1.8271, 3])
    coord.append([-1.6268, 3.6541, 2.75])
    coord.append([-2.4402, 5.4812, 2.25])
    coord.append([-3.2536 ,7.3083, 1.75])
    coord.append([-4.0673, 9.1352 ,1])
    coord.append([-4.8807, 10.9623, -0.5])
    coord.append([-0.5, 0.866, 4])
    
    coord.append([-1.5 ,2.5981 ,3.75])
    coord.append([-2.5, 4.3301 ,3.25])
    coord.append([-3.5, 6.0622, 2.75])
    coord.append([-4.5, 7.7942 ,2])
    coord.append([-5.5, 9.5263 ,1.25])
    coord.append([-6.5, 11.2583, 0])
    coord.append([-1.1755, 1.6180, 3])
    coord.append([-2.3510, 3.2361, 2.75])
    coord.append([-3.5265, 4.8541, 2.25])
    coord.append([-4.702, 6.4721, 1.75])
    
    coord.append([-5.8778, 8.09, 1])
    coord.append([-7.0533 ,9.708, -0.5])
    coord.append([-0.6691 ,0.7431, 4])
    coord.append([-2.0074, 2.2294 ,3.75])
    coord.append([-3.3457, 3.7157, 3.25])
    coord.append([-4.6839, 5.2020, 2.75])
    coord.append([-6.0222 ,6.6883, 2])
    coord.append([-7.3604 ,8.1746, 1.25])
    coord.append([-8.6987 ,9.6609, 0])
    coord.append([-1.4862, 1.3383, 3])
    
    coord.append([-2.9724 ,2.6765 ,2.75])
    coord.append([-4.4587 ,4.0148 ,2.25])
    coord.append([-5.9449, 5.3531 ,1.75])
    coord.append([-7.4313, 6.6911 ,1])
    coord.append([-8.9175, 8.0294, -0.5])
    coord.append([-0.809, 0.5878, 4])
    coord.append([-2.4271 ,1.7634 ,3.75])
    coord.append([-4.0451, 2.9389, 3.25])
    coord.append([-5.6631, 4.1145, 2.75])
    coord.append([-7.2812 ,5.2901, 2])
    
    coord.append([-8.8992 ,6.4656, 1.25])
    coord.append([-10.5172 ,7.6412 ,0])
    coord.append([-1.7320, 1, 3])
    coord.append([-3.464, 2, 2.75])
    coord.append([-5.196 ,3.0001, 2.25])
    coord.append([-6.9279 ,4.0001 ,1.75])
    coord.append([-8.6601, 4.9999 ,1])
    coord.append([-10.3921, 5.9999, -0.5])
    coord.append([-0.9136, 0.4067, 4])
    coord.append([-2.7406 ,1.2202, 3.75])
    
    coord.append([-4.5677, 2.0337 ,3.25])
    coord.append([-6.3948, 2.8472, 2.75])
    coord.append([-8.2219, 3.6606, 2])
    coord.append([-10.049, 4.4741, 1.25])
    coord.append([-11.8761, 5.2876, 0])
    coord.append([-1.9021, 0.6181, 3])
    coord.append([-3.8041, 1.2361, 2.75])
    coord.append([-5.7062, 1.8542, 2.25])
    coord.append([-7.6082, 2.4723, 1.75])
    coord.append([-9.5104, 3.0901, 1])
    
    coord.append([-11.4124, 3.7081, -0.5])
    coord.append([-0.9782, 0.2079, 4])
    coord.append([-2.9344, 0.6237, 3.75])
    coord.append([-4.8907, 1.0396, 3.25])
    coord.append([-6.847, 1.4554, 2.75])
    coord.append([-8.8033, 1.8712, 2])
    coord.append([-10.7596, 2.287, 1.25])
    coord.append([-12.7159, 2.7029, 0])
    coord.append([-1.9890, 0.2091, 3])
    coord.append([-3.978, 0.4182, 2.75])
    
    coord.append([-5.967, 0.6273, 2.25])
    coord.append([-7.956, 0.8364, 1.75])
    coord.append([-9., 1.0452 ,1])
    coord.append([-11.934 ,1.2543 ,-0.5])
    coord.append([-1, 0 ,4])
    coord.append([-3, 0, 3.75])
    coord.append([-5, 0, 3.25])
    coord.append([-7 ,0 ,2.75])
    coord.append([-9 ,0, 2])
    coord.append([-11, 0, 1.25])

    coord.append([-13, 0, 0])
    coord.append([-1.989, -0.209,3])
    coord.append([-3.978 ,-0.418, 2.75])
    coord.append([-5.967 ,-0.627, 2.25])
    coord.append([-7.956 ,-0.836, 1.75])
    coord.append([-9.945, -1.0453, 1])
    coord.append([-11.934, -1.2543, -0.5])
    coord.append([-0.9782, -0.2079, 4])
    coord.append([-2.9344, -0.6237, 3.75])
    coord.append([-4.8907, -1.0396, 3.25])
    
    coord.append([-6.847, -1.4554 ,2.75])
    coord.append([-8.8033 ,-1.8712, 2])
    coord.append([-10.7596, -2.287, 1.25])
    coord.append([-12.7159, -2.7029, 0])
    coord.append([-1.9021 ,-0.618 ,3])
    coord.append([-3.8042 ,-1.2359, 2.75])
    coord.append([-5.7063 ,-1.8539, 2.25])
    coord.append([-7.6083, -2.4719, 1.75])
    coord.append([-9.5104 ,-3.0901, 1])
    coord.append([-11.4124, -3.7081, -0.5])
    
    coord.append([-0.9136, -0.4067, 4])
    coord.append([-2.7406, -1.2202, 3.75])
    coord.append([-4.5677, -2.0337, 3.25])
    coord.append([-6.3948, -2.8472, 2.75])
    coord.append([-8.2219, -3.6606, 2])
    coord.append([-10.049, -4.4741, 1.25])
    coord.append([-11.8761, -5.2876, 0])
    coord.append([-1.732 ,-0.9999 ,3])
    coord.append([-3.4641, -1.9999, 2.75])
    coord.append([-5.1961, -2.9998, 2.25])
    
    coord.append([-6.9281, -3.9997, 1.75])
    coord.append([-8.6601, -4.9999, 1])
    coord.append([-10.3921, -5.9999, -0.5])
    coord.append([-0.809 ,-0.5878 ,4])
    coord.append([-2.4271, -1.7634, 3.75])
    coord.append([-4.0451, -2.9389, 3.25])
    coord.append([-5.6631, -4.1145, 2.75])
    coord.append([-7.2812, -5.2901, 2])
    coord.append([-8.8992, -6.4656, 1.25])
    coord.append([-10.5172, -7.6412, 0])
    
    coord.append([-1.4863, -1.3382, 3])
    coord.append([-2.9726, -2.6764, 2.75])
    coord.append([-4.4589, -4.0146, 2.25])
    coord.append([-5.9452, -5.3528, 1.75])
    coord.append([-7.4313,	-6.6912, 1])
    coord.append([-8.9176, -8.0294, -0.5])
    coord.append([-0.6691, -0.7431 ,4])
    coord.append([-2.0074, -2.2294, 3.75])
    coord.append([-3.3457, -3.7157, 3.25])
    coord.append([-4.6839, -5.2020, 2.75])
    
    coord.append([-6.0222, -6.6883 ,2])
    coord.append([-7.3604,	-8.1746, 1.25])
    coord.append([-8.6987, -9.6609, 0])
    coord.append([-1.1756, -1.6180, 3])
    coord.append([-2.3512, -3.2359, 2.75])
    coord.append([-3.5268, -4.8539, 2.25])
    coord.append([-4.7023, -6.4719, 1.75])
    coord.append([-5.8777,	-8.09, 1])
    coord.append([-7.0533, -9.708, -0.5])
    coord.append([-0.5 ,-0.866 ,4])
    
    coord.append([-1.5, -2.5981, 3.75])
    coord.append([-2.5, -4.3301, 3.25])
    coord.append([-3.5, -6.0622, 2.75])
    coord.append([-4.5, -7.7942, 2])
    coord.append([-5.5, -9.5263, 1.25])
    coord.append([-6.5, -11.2583, 0])
    coord.append([-0.8135, -1.827, 3])
    coord.append([-1.627 ,-3.6541, 2.75])
    coord.append([-2.4405, -5.4811, 2.25])
    coord.append([-3.2540, -7.3081, 1.75])
    
    coord.append([-4.0672 ,-9.1353 ,1])
    coord.append([-4.8807, -10.9623, -0.5])
    coord.append([-0.309 ,-0.9511 ,4])
    coord.append([-0.9271, -2.8532, 3.75])
    coord.append([-1.5451, -4.7553, 3.25])
    coord.append([-2.1631, -6.6574, 2.75])
    coord.append([-2.7812, -8.5595, 2])
    coord.append([-3.3992, -10.4616, 1.25])
    coord.append([-4.0172, -12.3637, 0])
    coord.append([-0.4159, -1.9562 ,3])

    coord.append([-0.8317, -3.9125, 2.75])
    coord.append([-1.2476, -5.8687, 2.25])
    coord.append([-1.6635, -7.8249, 1.75])
    coord.append([-2.079 ,-9.7813 ,1])
    coord.append([-2.4949, -11.7375, -0.5])
    coord.append([-0.1045, -0.9945 ,4])
    coord.append([-0.3136, -2.9836 ,3.75])
    coord.append([-0.5226, -4.9726 ,3.25])
    coord.append([-0.7317, -6.9617 ,2.75])
    coord.append([-0.9408, -8.9507 ,2])
    
    coord.append([-1.1498, -10.9397, 1.25])
    coord.append([-1.3589, -12.9288, 0])
    coord.append([-0.0001, -2 ,3])
    coord.append([-0.0001, -3.9999, 2.75])
    coord.append([-0.0002, -5.9999, 2.25])
    coord.append([-0.0002, -7.9998, 1.75])
    coord.append([0 ,-9.9998 ,1])
    coord.append([0 ,-11.9997, -0.5])
    coord.append([0.1045, -0.9945, 4])
    coord.append([0.3136, -2.9836, 3.75])
    
    coord.append([0.5226, -4.9726, 3.25])
    coord.append([0.7317, -6.9617, 2.75])
    coord.append([0.9408, -8.9507, 2])
    coord.append([1.1498, -10.9397, 1.25])
    coord.append([1.3589, -12.9288, 0])
    coord.append([0.4158, -1.9563, 3])
    coord.append([0.8315, -3.9125, 2.75])
    coord.append([1.2473, -5.8688, 2.25])
    coord.append([1.6631, -7.825, 1.75])
    coord.append([2.0791, -9.7813, 1])
    
    coord.append([2.4949, -11.7375, -0.5])
    coord.append([0.309 ,-0.9511 ,4])
    coord.append([0.9271, -2.8532, 3.75])
    coord.append([1.5451, -4.7553, 3.25])
    coord.append([2.1631, -6.6574, 2.75])
    coord.append([2.7812, -8.5595, 2])
    coord.append([3.3992, -10.4616, 1.25])
    coord.append([4.0172, -12.3637, 0])
    coord.append([0.8134, -1.8271 ,3])
    coord.append([1.6268, -3.6541 ,2.75])
    
    coord.append([2.4402, -5.4812 ,2.25])
    coord.append([3.2536, -7.3083, 1.75])
    coord.append([4.0673, -9.1352, 1])
    coord.append([4.8807, -10.9623, -0.5])
    coord.append([0.5 ,-0.866 ,4])
    coord.append([1.5 ,-2.5981, 3.75])
    coord.append([2.5 ,-4.3301, 3.25])
    coord.append([3.5 ,-6.0622, 2.75])
    coord.append([4.5 ,-7.7942, 2])
    coord.append([5.5 ,-9.5263, 1.25])
    
    coord.append([6.5 ,-11.2583, 0])
    coord.append([1.1755, -1.6180, 3])
    coord.append([2.351 ,-3.2361 ,2.75])
    coord.append([3.5265, -4.8541, 2.25])
    coord.append([4.702 ,-6.4721 ,1.75])
    coord.append([5.8778, -8.09 ,1])
    coord.append([7.0533, -9.708, -0.5])
    coord.append([0.6691, -0.7431, 4])
    coord.append([2.0074, -2.2294, 3.75])
    coord.append([3.3457, -3.7157, 3.25])
    
    coord.append([4.6839, -5.2020, 2.75])
    coord.append([6.0222, -6.6883, 2])
    coord.append([7.3604, -8.1746, 1.25])
    coord.append([8.6987, -9.6609, 0])
    coord.append([1.4862, -1.3383, 3])
    coord.append([2.9724, -2.6765, 2.75])
    coord.append([4.4587, -4.0148, 2.25])
    coord.append([5.9449, -5.3531, 1.75])
    coord.append([7.4313, -6.6911, 1])
    coord.append([8.9175, -8.0294, -0.5])
    
    coord.append([0.809, -0.5878, 4])
    coord.append([2.4271, -1.7634, 3.75])
    coord.append([4.0451, -2.9389, 3.25])
    coord.append([5.6631, -4.1145, 2.75])
    coord.append([7.2812, -5.2901, 2])
    coord.append([8.8992, -6.4656, 1.25])
    coord.append([10.5172, -7.6412, 0])
    coord.append([1.7320 ,-1 ,3])
    coord.append([3.464 ,-2 ,2.75])
    coord.append([5.196 ,-3.0001, 2.25])

    coord.append([6.9279, -4.0001 ,1.75])
    coord.append([8.6601 ,-4.9999 ,1])
    coord.append([10.3921, -5.9999, -0.5])
    coord.append([0.9136 ,-0.4067 ,4])
    coord.append([2.7406 ,-1.2202 ,3.75])
    coord.append([4.5677 ,-2.0337 ,3.25])
    coord.append([6.3948 ,-2.8472 ,2.75])
    coord.append([8.2219 ,-3.6606 ,2])
    coord.append([10.049 ,-4.4741 ,1.25])
    coord.append([11.8761, -5.2876, 0])
    
    coord.append([1.9021, -0.6181 ,3])
    coord.append([3.8041, -1.2361 ,2.75])
    coord.append([5.7062, -1.8542 ,2.25])
    coord.append([7.6082, -2.4723 ,1.75])
    coord.append([9.5104, -3.0901 ,1])
    coord.append([11.4124, -3.7081, -0.5])
    coord.append([0.9782 ,-0.2079 ,4])
    coord.append([2.9344 ,-0.6237 ,3.75])
    coord.append([4.8907 ,-1.0396 ,3.25])
    coord.append([6.847 ,-1.4554 ,2.75])
    
    coord.append([8.8033,-1.8712 ,2])
    coord.append([10.7596, -2.287 ,1.25])
    coord.append([12.7159, -2.7029, 0])
    coord.append([1.9890 ,-0.2091, 3])
    coord.append([3.978 ,-0.4182, 2.75])
    coord.append([5.967 ,-0.6273, 2.25])
    coord.append([7.956 ,-0.8364, 1.75])
    coord.append([9.945 ,-1.0452 ,1])
    coord.append([11.934, -1.2543, -0.5])      
    
    coord = np.array(coord).astype(float)
#connec
# Layer 0          
    connec.append([1,2])
    connec.append([1,8])
    connec.append([1,14])
    connec.append([2,3])
    connec.append([2,8])
    connec.append([2,9])
    connec.append([2,15])
    connec.append([3,4])
    connec.append([3,9])
    connec.append([3,10])
    connec.append([3,16])
    connec.append([4,5])
    connec.append([4,10])
    connec.append([4,11])
    connec.append([4,17])
    connec.append([5,6])
    connec.append([5,11])
    connec.append([5,12])
    connec.append([5,18])
    connec.append([6,7])
    connec.append([6,12])
    connec.append([6,13])
    connec.append([6,19])
    connec.append([7,13])
    connec.append([8,9])
    connec.append([8,14])
    connec.append([8,15])
    connec.append([8,21])
    connec.append([9,10])
    connec.append([9,15])
    connec.append([9,16])
    connec.append([9,22])
    connec.append([10,11])
    connec.append([10,16])
    connec.append([10,17])
    connec.append([10,23])
    connec.append([11,12])
    connec.append([11,17])
    connec.append([11,18])
    connec.append([11,24])
    connec.append([12,13])
    connec.append([12,18])
    connec.append([12,19])
    connec.append([12,25])
    connec.append([13,19])
    connec.append([13,20])
    connec.append([13,26])
    connec.append([14,15])
    connec.append([14,21])
    connec.append([14,27])
    connec.append([15,16])
    connec.append([15,21])
    connec.append([15,22])
    connec.append([15,28])
    connec.append([16,17])
    connec.append([16,22])
    connec.append([16,23])
    connec.append([16,29])
    connec.append([17,18])
    connec.append([17,23])
    connec.append([17,24])
    connec.append([17,30])
    connec.append([18,19])
    connec.append([18,24])
    connec.append([18,25])
    connec.append([18,31])
    connec.append([19,20])
    connec.append([19,25])
    connec.append([19,26])
    connec.append([19,32])
    connec.append([20,26])
    connec.append([21,22])
    connec.append([21,27])
    connec.append([21,28])
    connec.append([21,34])
    connec.append([22,23])
    connec.append([22,28])
    connec.append([22,29])
    connec.append([22,35])
    connec.append([23,24])
    connec.append([23,29])
    connec.append([23,30])
    connec.append([23,36])
    connec.append([24,25])
    connec.append([24,30])
    connec.append([24,31])
    connec.append([24,37])
    connec.append([25,26])
    connec.append([25,31])
    connec.append([25,32])
    connec.append([25,38])
    connec.append([26,32])
    connec.append([26,33])
    connec.append([26,39])
    connec.append([27,28])
    connec.append([27,34])
    connec.append([27,40])
    connec.append([28,29])
    connec.append([28,34])
    connec.append([28,35])
    connec.append([28,41])
    connec.append([29,30])
    connec.append([29,35])
    connec.append([29,36])
    connec.append([29,42])
    connec.append([30,31])
    connec.append([30,36])
    connec.append([30,37])
    connec.append([30,43])
    connec.append([31,32])
    connec.append([31,37])
    connec.append([31,38])
    connec.append([31,44])
    connec.append([32,33])
    connec.append([32,38])
    connec.append([32,39])
    connec.append([32,45])
    connec.append([33,39])
    connec.append([34,35])
    connec.append([34,40])
    connec.append([34,41])
    connec.append([34,47])
    connec.append([35,36])
    connec.append([35,41])
    connec.append([35,42])
    connec.append([35,48])
    connec.append([36,37])
    connec.append([36,42])
    connec.append([36,43])
    connec.append([36,49])
    connec.append([37,38])
    connec.append([37,43])
    connec.append([37,44])
    connec.append([37,50])
    connec.append([38,39])
    connec.append([38,44])
    connec.append([38,45])
    connec.append([38,51])
    connec.append([39,45])
    connec.append([39,46])
    connec.append([39,52])
    connec.append([40,41])
    connec.append([40,47])
    connec.append([40,53])
    connec.append([41,42])
    connec.append([41,47])
    connec.append([41,48])
    connec.append([41,54])
    connec.append([42,43])
    connec.append([42,48])
    connec.append([42,49])
    connec.append([42,55])
    connec.append([43,44])
    connec.append([43,49])
    connec.append([43,50])
    connec.append([43,56])
    connec.append([44,45])
    connec.append([44,50])
    connec.append([44,51])
    connec.append([44,57])
    connec.append([45,46])
    connec.append([45,51])
    connec.append([45,52])
    connec.append([45,58])
    connec.append([46,52])
    connec.append([47,48])
    connec.append([47,53])
    connec.append([47,54])
    connec.append([47,60])
    connec.append([48,49])
    connec.append([48,54])
    connec.append([48,55])
    connec.append([48,61])
    connec.append([49,50])
    connec.append([49,55])
    connec.append([49,56])
    connec.append([49,62])
    connec.append([50,51])
    connec.append([50,56])
    connec.append([50,57])
    connec.append([50,63])
    connec.append([51,52])
    connec.append([51,57])
    connec.append([51,58])
    connec.append([51,64])
    connec.append([52,58])
    connec.append([52,59])
    connec.append([52,65])
    connec.append([53,54])
    connec.append([53,60])
    connec.append([53,66])
    connec.append([54,55])
    connec.append([54,60])
    connec.append([54,61])
    connec.append([54,67])
    connec.append([55,56])
    connec.append([55,61])
    connec.append([55,62])
    connec.append([55,68])
    connec.append([56,57])
    connec.append([56,62])
    connec.append([56,63])
    connec.append([56,69])
    connec.append([57,58])
    connec.append([57,63])
    connec.append([57,64])
    connec.append([57,70])
    connec.append([58,59])
    connec.append([58,64])
    connec.append([58,65])
    connec.append([58,71])
    connec.append([59,65])
    connec.append([60,61])
    connec.append([60,66])
    connec.append([60,67])
    connec.append([60,73])
    connec.append([61,62])
    connec.append([61,67])
    connec.append([61,68])
    connec.append([61,74])
    connec.append([62,63])
    connec.append([62,68])
    connec.append([62,69])
    connec.append([62,75])
    connec.append([63,64])
    connec.append([63,69])
    connec.append([63,70])
    connec.append([63,76])
    connec.append([64,65])
    connec.append([64,70])
    connec.append([64,71])
    connec.append([64,77])
    connec.append([65,71])
    connec.append([65,72])
    connec.append([65,78])
    connec.append([66,67])
    connec.append([66,73])
    connec.append([66,79])
    connec.append([67,68])
    connec.append([67,73])
    connec.append([67,74])
    connec.append([67,80])
    connec.append([68,69])
    connec.append([68,74])
    connec.append([68,75])
    connec.append([68,81])
    connec.append([69,70])
    connec.append([69,75])
    connec.append([69,76])
    connec.append([69,82])
    connec.append([70,71])
    connec.append([70,76])
    connec.append([70,77])
    connec.append([70,83])
    connec.append([71,72])
    connec.append([71,77])
    connec.append([71,78])
    connec.append([71,84])
    connec.append([72,78])
    connec.append([73,74])
    connec.append([73,79])
    connec.append([73,80])
    connec.append([73,86])
    connec.append([74,75])
    connec.append([74,80])
    connec.append([74,81])
    connec.append([74,87])
    connec.append([75,76])
    connec.append([75,81])
    connec.append([75,82])
    connec.append([75,88])
    connec.append([76,77])
    connec.append([76,82])
    connec.append([76,83])
    connec.append([76,89])
    connec.append([77,78])
    connec.append([77,83])
    connec.append([77,84])
    connec.append([77,90])
    connec.append([78,84])
    connec.append([78,85])
    connec.append([78,91])
    connec.append([79,80])
    connec.append([79,86])
    connec.append([79,92])
    connec.append([80,81])
    connec.append([80,86])
    connec.append([80,87])
    connec.append([80,93])
    connec.append([81,82])
    connec.append([81,87])
    connec.append([81,88])
    connec.append([81,94])
    connec.append([82,83])
    connec.append([82,88])
    connec.append([82,89])
    connec.append([82,95])
    connec.append([83,84])
    connec.append([83,89])
    connec.append([83,90])
    connec.append([83,96])
    connec.append([84,85])
    connec.append([84,90])
    connec.append([84,91])
    connec.append([84,97])
    connec.append([85,91])
    connec.append([86,87])
    connec.append([86,92])
    connec.append([86,93])
    connec.append([86,99])
    connec.append([87,88])
    connec.append([87,93])
    connec.append([87,94])
    connec.append([87,100])
    connec.append([88,89])
    connec.append([88,94])
    connec.append([88,95])
    connec.append([88,101])
    connec.append([89,90])
    connec.append([89,95])
    connec.append([89,96])
    connec.append([89,102])
    connec.append([90,91])
    connec.append([90,96])
    connec.append([90,97])
    connec.append([90,103])
    connec.append([91,97])
    connec.append([91,98])
    connec.append([91,104])
    connec.append([92,93])
    connec.append([92,99])
    connec.append([92,105])
    connec.append([93,94])
    connec.append([93,99])
    connec.append([93,100])
    connec.append([93,106])
    connec.append([94,95])
    connec.append([94,100])
    connec.append([94,101])
    connec.append([94,107])
    connec.append([95,96])
    connec.append([95,101])
    connec.append([95,102])
    connec.append([95,108])
    connec.append([96,97])
    connec.append([96,102])
    connec.append([96,103])
    connec.append([96,109])
    connec.append([97,98])
    connec.append([97,103])
    connec.append([97,104])
    connec.append([97,110])
    connec.append([98,104])
    connec.append([99,100])
    connec.append([99,105])
    connec.append([99,106])
    connec.append([99,112])
    connec.append([100,101])
    connec.append([100,106])
    connec.append([100,107])
    connec.append([100,113])
    connec.append([101,102])
    connec.append([101,107])
    connec.append([101,108])
    connec.append([101,114])
    connec.append([102,103])
    connec.append([102,108])
    connec.append([102,109])
    connec.append([102,115])
    connec.append([103,104])
    connec.append([103,109])
    connec.append([103,110])
    connec.append([103,116])
    connec.append([104,110])
    connec.append([104,111])
    connec.append([104,117])
    connec.append([105,106])
    connec.append([105,112])
    connec.append([105,118])
    connec.append([106,107])
    connec.append([106,112])
    connec.append([106,113])
    connec.append([106,119])
    connec.append([107,108])
    connec.append([107,113])
    connec.append([107,114])
    connec.append([107,120])
    connec.append([108,109])
    connec.append([108,114])
    connec.append([108,115])
    connec.append([108,121])
    connec.append([109,110])
    connec.append([109,115])
    connec.append([109,116])
    connec.append([109,122])
    connec.append([110,111])
    connec.append([110,116])
    connec.append([110,117])
    connec.append([110,123])
    connec.append([111,117])
    connec.append([112,113])
    connec.append([112,118])
    connec.append([112,119])
    connec.append([112,125])
    connec.append([113,114])
    connec.append([113,119])
    connec.append([113,120])
    connec.append([113,126])
    connec.append([114,115])
    connec.append([114,120])
    connec.append([114,121])
    connec.append([114,127])
    connec.append([115,116])
    connec.append([115,121])
    connec.append([115,122])
    connec.append([115,128])
    connec.append([116,117])
    connec.append([116,122])
    connec.append([116,123])
    connec.append([116,129])
    connec.append([117,123])
    connec.append([117,124])
    connec.append([117,130])
    connec.append([118,119])
    connec.append([118,125])
    connec.append([118,131])
    connec.append([119,120])
    connec.append([119,125])
    connec.append([119,126])
    connec.append([119,132])
    connec.append([120,121])
    connec.append([120,126])
    connec.append([120,127])
    connec.append([120,133])
    connec.append([121,122])
    connec.append([121,127])
    connec.append([121,128])
    connec.append([121,134])
    connec.append([122,123])
    connec.append([122,128])
    connec.append([122,129])
    connec.append([122,135])
    connec.append([123,124])
    connec.append([123,129])
    connec.append([123,130])
    connec.append([123,136])
    connec.append([124,130])
    connec.append([125,126])
    connec.append([125,131])
    connec.append([125,132])
    connec.append([125,138])
    connec.append([126,127])
    connec.append([126,132])
    connec.append([126,133])
    connec.append([126,139])
    connec.append([127,128])
    connec.append([127,133])
    connec.append([127,134])
    connec.append([127,140])
    connec.append([128,129])
    connec.append([128,134])
    connec.append([128,135])
    connec.append([128,141])
    connec.append([129,130])
    connec.append([129,135])
    connec.append([129,136])
    connec.append([129,142])
    connec.append([130,136])
    connec.append([130,137])
    connec.append([130,143])
    connec.append([131,132])
    connec.append([131,138])
    connec.append([131,144])
    connec.append([132,133])
    connec.append([132,138])
    connec.append([132,139])
    connec.append([132,145])
    connec.append([133,134])
    connec.append([133,139])
    connec.append([133,140])
    connec.append([133,146])
    connec.append([134,135])
    connec.append([134,140])
    connec.append([134,141])
    connec.append([134,147])
    connec.append([135,136])
    connec.append([135,141])
    connec.append([135,142])
    connec.append([135,148])
    connec.append([136,137])
    connec.append([136,142])   
    connec.append([136,142])
    connec.append([136,143])
    connec.append([136,149])
    connec.append([137,143])
    connec.append([138,139])
    connec.append([138,144])
    connec.append([138,145])
    connec.append([138,151])
    connec.append([139,140])
    connec.append([139,145])
    connec.append([139,146])
    connec.append([139,152])
    connec.append([140,141])
    connec.append([140,146])
    connec.append([140,147])
    connec.append([140,153])
    connec.append([141,147])
    connec.append([141,148])
    connec.append([141,154])
    connec.append([142,143])
    connec.append([142,148])
    connec.append([142,149])
    connec.append([142,155])
    connec.append([143,149])
    connec.append([143,150])
    connec.append([143,156])
    connec.append([144,145])
    connec.append([144,151])
    connec.append([144,157])
    connec.append([145,146])
    connec.append([145,151])
    connec.append([145,152])
    connec.append([145,158])
    connec.append([146,147])
    connec.append([146,152])
    connec.append([146,153])
    connec.append([146,159])
    connec.append([147,148])
    connec.append([147,153])
    connec.append([147,154])
    connec.append([147,160])
    connec.append([148,149])
    connec.append([148,154])
    connec.append([148,155])
    connec.append([148,161])
    connec.append([149,150])
    connec.append([149,155])
    connec.append([149,156])
    connec.append([149,162])
    connec.append([150,156])
    connec.append([151,152])
    connec.append([151,157])
    connec.append([151,158])
    connec.append([151,164])
    connec.append([152,153])
    connec.append([152,158])
    connec.append([152,159])
    connec.append([152,165])
    connec.append([153,154])
    connec.append([153,159])
    connec.append([153,160])
    connec.append([153,166])
    connec.append([154,155])
    connec.append([154,160])
    connec.append([154,161])
    connec.append([154,167])
    connec.append([155,156])
    connec.append([155,161])
    connec.append([155,162])
    connec.append([155,168])
    connec.append([156,162])
    connec.append([156,163])
    connec.append([156,169])
    connec.append([157,158])
    connec.append([157,164])
    connec.append([157,170])
    connec.append([158,159])
    connec.append([158,164])
    connec.append([158,165])
    connec.append([158,171])
    connec.append([159,160])
    connec.append([159,165])
    connec.append([159,166])
    connec.append([159,172])
    connec.append([160,161])
    connec.append([160,166])
    connec.append([160,167])
    connec.append([160,173])
    connec.append([161,162])
    connec.append([161,167])
    connec.append([161,168])
    connec.append([161,174])
    connec.append([162,163])
    connec.append([162,168])
    connec.append([162,169])
    connec.append([162,175])
    connec.append([163,169])
    connec.append([164,165])
    connec.append([164,170])
    connec.append([164,171])
    connec.append([164,177])
    connec.append([165,166])
    connec.append([165,171])
    connec.append([165,172])
    connec.append([165,178])
    connec.append([166,167])
    connec.append([166,172])
    connec.append([166,173])
    connec.append([166,179])
    connec.append([167,168])
    connec.append([167,173])
    connec.append([167,174])
    connec.append([167,180])
    connec.append([168,169])
    connec.append([168,174])
    connec.append([168,175])
    connec.append([168,181])
    connec.append([169,175])
    connec.append([169,176])
    connec.append([169,182])
    connec.append([170,171])
    connec.append([170,177])
    connec.append([170,183])
    connec.append([171,172])
    connec.append([171,177])
    connec.append([171,178])
    connec.append([171,184])
    connec.append([172,173])
    connec.append([172,178])
    connec.append([172,179])
    connec.append([172,185])
    connec.append([173,174])
    connec.append([173,179])
    connec.append([173,180])
    connec.append([173,186])
    connec.append([174,175])
    connec.append([174,180])
    connec.append([174,181])
    connec.append([174,187])
    connec.append([175,176])
    connec.append([175,181])
    connec.append([175,182])
    connec.append([175,188])
    connec.append([176,182])
    connec.append([177,178])
    connec.append([177,183])
    connec.append([177,184])
    connec.append([177,190])
    connec.append([178,179])
    connec.append([178,184])
    connec.append([178,185])
    connec.append([178,191])
    connec.append([179,180])
    connec.append([179,185])
    connec.append([179,186])
    connec.append([179,192])
    connec.append([180,181])
    connec.append([180,186])
    connec.append([180,187])
    connec.append([180,193])
    connec.append([181,182])
    connec.append([181,187])
    connec.append([181,188])
    connec.append([181,194])
    connec.append([182,188])
    connec.append([182,189])
    connec.append([182,195])
    connec.append([183,184])
    connec.append([183,190])
    connec.append([183,196])
    connec.append([184,185])
    connec.append([184,190])
    connec.append([184,191])
    connec.append([184,197])
    connec.append([185,186])
    connec.append([185,191])
    connec.append([185,192])
    connec.append([185,198])
    connec.append([186,187])
    connec.append([186,192])
    connec.append([186,193])
    connec.append([186,199])
    connec.append([187,188])
    connec.append([187,193])
    connec.append([187,194])
    connec.append([187,200])
    connec.append([188,189])
    connec.append([188,194])
    connec.append([188,195])
    connec.append([188,201])
    connec.append([189,195])
    connec.append([190,191])
    connec.append([190,196])
    connec.append([190,197])
    connec.append([190,203])
    connec.append([191,192])
    connec.append([191,197])
    connec.append([191,198])
    connec.append([191,204])
    connec.append([192,193])
    connec.append([192,198])
    connec.append([192,199])
    connec.append([192,205])
    connec.append([193,194])
    connec.append([193,199])
    connec.append([193,200])
    connec.append([193,206])
    connec.append([194,195])
    connec.append([194,200])
    connec.append([194,201])
    connec.append([194,207])
    connec.append([195,201])
    connec.append([195,202])
    connec.append([195,208])
    connec.append([196,197])
    connec.append([196,203])
    connec.append([196,209])
    connec.append([197,198])
    connec.append([197,203])
    connec.append([197,204])
    connec.append([197,210])
    connec.append([198,199])
    connec.append([198,204])
    connec.append([198,205])
    connec.append([198,211])
    connec.append([199,200])
    connec.append([199,205])
    connec.append([199,206])
    connec.append([199,212])
    connec.append([200,201])
    connec.append([200,206])
    connec.append([200,207])
    connec.append([200,213])
    connec.append([201,202])
    connec.append([201,207])
    connec.append([201,208])
    connec.append([201,214])
    connec.append([202,208])
    connec.append([203,204])
    connec.append([203,209])
    connec.append([203,210])
    connec.append([203,216])
    connec.append([204,205])
    connec.append([204,210])
    connec.append([204,211])
    connec.append([204,217])
    connec.append([205,206])
    connec.append([205,211])
    connec.append([205,212])
    connec.append([205,218])
    connec.append([206,207])
    connec.append([206,212])
    connec.append([206,213])
    connec.append([206,219])
    connec.append([207,208])
    connec.append([207,213])
    connec.append([207,214])
    connec.append([207,220])
    connec.append([208,214])
    connec.append([208,215])
    connec.append([208,221])
    connec.append([209,210])
    connec.append([209,216])
    connec.append([209,222])
    connec.append([210,211])
    connec.append([210,216])
    connec.append([210,217])
    connec.append([210,223])
    connec.append([211,212])
    connec.append([211,217])
    connec.append([211,218])
    connec.append([211,224])
    connec.append([212,213])
    connec.append([212,218])
    connec.append([212,219])
    connec.append([212,225])
    connec.append([213,214])
    connec.append([213,219])
    connec.append([213,220])
    connec.append([213,226])
    connec.append([214,215])
    connec.append([214,220])
    connec.append([214,221])
    connec.append([214,227])
    connec.append([215,221])
    connec.append([216,217])
    connec.append([216,222])
    connec.append([216,223])
    connec.append([216,229])
    connec.append([217,218])
    connec.append([217,223])
    connec.append([217,224])
    connec.append([217,230])
    connec.append([218,219])
    connec.append([218,224])
    connec.append([218,225])
    connec.append([218,231])
    connec.append([219,220])
    connec.append([219,225])
    connec.append([219,226])
    connec.append([219,232])
    connec.append([220,221])
    connec.append([220,226])
    connec.append([220,227])
    connec.append([220,233])
    connec.append([221,227])
    connec.append([221,228])
    connec.append([221,234])
    connec.append([222,223])
    connec.append([222,229])
    connec.append([222,235])
    connec.append([223,224])
    connec.append([223,229])
    connec.append([223,230])
    connec.append([223,236])
    connec.append([224,225])
    connec.append([224,230])
    connec.append([224,231])
    connec.append([224,237])
    connec.append([225,226])
    connec.append([225,231])
    connec.append([225,232])
    connec.append([225,238])
    connec.append([226,227])
    connec.append([226,232])
    connec.append([226,233])
    connec.append([226,239])
    connec.append([227,228])
    connec.append([227,233])
    connec.append([227,234])
    connec.append([227,240])
    connec.append([228,234])
    connec.append([229,230])
    connec.append([229,235])
    connec.append([229,236])
    connec.append([229,242])
    connec.append([230,231])
    connec.append([230,236])
    connec.append([230,237])
    connec.append([230,243])
    connec.append([231,232])
    connec.append([231,237])
    connec.append([231,238])
    connec.append([231,244])
    connec.append([232,233])
    connec.append([232,238])
    connec.append([232,239])
    connec.append([232,245])
    connec.append([233,234])
    connec.append([233,239])
    connec.append([233,240])
    connec.append([233,246])
    connec.append([234,240])
    connec.append([234,241])
    connec.append([234,247])
    connec.append([235,236])
    connec.append([235,242])
    connec.append([235,248])
    connec.append([236,237])
    connec.append([236,242])
    connec.append([236,243])
    connec.append([236,249])
    connec.append([237,238])
    connec.append([237,243])
    connec.append([237,244])
    connec.append([237,250])
    connec.append([238,239])
    connec.append([238,244])
    connec.append([238,245])
    connec.append([238,251])
    connec.append([239,240])
    connec.append([239,245])
    connec.append([239,246])
    connec.append([239,252])
    connec.append([240,241])
    connec.append([240,246])
    connec.append([240,247])
    connec.append([240,253])
    connec.append([241,247])
    connec.append([242,243])
    connec.append([242,248])
    connec.append([242,249])
    connec.append([242,255])
    connec.append([243,244])
    connec.append([243,249])
    connec.append([243,250])
    connec.append([243,256])
    connec.append([244,245])
    connec.append([244,250])
    connec.append([244,251])
    connec.append([244,257])
    connec.append([245,246])
    connec.append([245,251])
    connec.append([245,252])
    connec.append([245,258])
    connec.append([246,247])
    connec.append([246,252])
    connec.append([246,253])
    connec.append([246,259])
    connec.append([247,253])
    connec.append([247,254])
    connec.append([247,260])
    connec.append([248,249])
    connec.append([248,255])
    connec.append([248,261])
    connec.append([249,250])
    connec.append([249,255])
    connec.append([249,256])
    connec.append([249,262])
    connec.append([250,251])
    connec.append([250,256])
    connec.append([250,257])
    connec.append([250,263])
    connec.append([251,252])
    connec.append([251,257])
    connec.append([251,258])
    connec.append([251,264])
    connec.append([252,253])
    connec.append([252,258])
    connec.append([252,259])
    connec.append([252,265])
    connec.append([253,254])
    connec.append([253,259])
    connec.append([253,260])
    connec.append([253,266])
    connec.append([254,260])
    connec.append([255,256])
    connec.append([255,261])
    connec.append([255,262])
    connec.append([255,268])
    connec.append([256,257])
    connec.append([256,262])
    connec.append([256,263])
    connec.append([256,269])
    connec.append([257,258])
    connec.append([257,263])
    connec.append([257,264])
    connec.append([257,270])
    connec.append([258,259])
    connec.append([258,264])
    connec.append([258,265])
    connec.append([258,271])
    connec.append([259,260])
    connec.append([259,265])
    connec.append([259,266])
    connec.append([259,272])
    connec.append([260,266])
    connec.append([260,267])
    connec.append([260,273])
    connec.append([261,262])
    connec.append([261,268])
    connec.append([261,274])
    connec.append([262,263])
    connec.append([262,268])
    connec.append([262,269])
    connec.append([262,275])
    connec.append([263,264])
    connec.append([263,269])
    connec.append([263,270])
    connec.append([263,276])
    connec.append([264,265])
    connec.append([264,270])
    connec.append([264,271])
    connec.append([264,277])
    connec.append([265,266])
    connec.append([265,271])
    connec.append([265,272])
    connec.append([265,278])
    connec.append([266,267])
    connec.append([266,272])
    connec.append([266,273])
    connec.append([266,279])
    connec.append([267,273])
    connec.append([268,269])
    connec.append([268,274])
    connec.append([268,275])
    connec.append([268,281])
    connec.append([269,270])
    connec.append([269,275])
    connec.append([269,276])
    connec.append([269,282])
    connec.append([270,271])
    connec.append([270,276])
    connec.append([270,277])
    connec.append([270,283])
    connec.append([271,272])
    connec.append([271,277])
    connec.append([271,278])
    connec.append([271,284])
    connec.append([272,273])
    connec.append([272,278])
    connec.append([272,279])
    connec.append([272,285])
    connec.append([273,279])
    connec.append([273,280])
    connec.append([273,285])
    connec.append([274,275])
    connec.append([274,281])
    connec.append([274,287])
    connec.append([275,276])
    connec.append([275,281])
    connec.append([275,282])
    connec.append([275,288])
    connec.append([276,277])
    connec.append([276,282])
    connec.append([276,283])
    connec.append([276,289])
    connec.append([277,278])
    connec.append([277,283])
    connec.append([277,284])
    connec.append([277,290])
    connec.append([278,279])
    connec.append([278,284])
    connec.append([278,285])
    connec.append([278,291])
    connec.append([279,280])
    connec.append([279,285])
    connec.append([279,286])
    connec.append([279,292])
    connec.append([280,286])
    connec.append([281,282])
    connec.append([281,287])
    connec.append([281,288])
    connec.append([281,294])
    connec.append([282,283])
    connec.append([282,288])
    connec.append([282,289])
    connec.append([282,295])
    connec.append([283,284])
    connec.append([283,289])
    connec.append([283,290])
    connec.append([283,296])
    connec.append([284,285])
    connec.append([284,290])
    connec.append([284,291])
    connec.append([284,297])
    connec.append([285,286])
    connec.append([285,291])
    connec.append([285,292])
    connec.append([285,298])
    connec.append([286,292])
    connec.append([286,293])
    connec.append([286,299])
    connec.append([287,288])
    connec.append([287,294])
    connec.append([287,300])
    connec.append([288,289])
    connec.append([288,294])
    connec.append([288,295])
    connec.append([288,301])
    connec.append([289,290])
    connec.append([289,295])
    connec.append([289,296])
    connec.append([289,302])
    connec.append([290,291])
    connec.append([290,296])
    connec.append([290,297])
    connec.append([290,303])
    connec.append([291,292])
    connec.append([291,297])
    connec.append([291,298])
    connec.append([291,304])
    connec.append([292,293])
    connec.append([292,298])
    connec.append([292,299])
    connec.append([292,305])
    connec.append([293,299])
    connec.append([294,295])
    connec.append([294,300])
    connec.append([294,301])
    connec.append([294,307])
    connec.append([295,296])
    connec.append([295,301])
    connec.append([295,302])
    connec.append([295,308])
    connec.append([296,297])
    connec.append([296,302])
    connec.append([296,303])
    connec.append([296,309])
    connec.append([297,298])
    connec.append([297,303])
    connec.append([297,304])
    connec.append([297,310])
    connec.append([298,299])
    connec.append([298,304])
    connec.append([298,305])
    connec.append([298,311])
    connec.append([299,305])
    connec.append([299,306])
    connec.append([299,312])
    connec.append([300,301])
    connec.append([300,307])
    connec.append([300,313])
    connec.append([301,302])
    connec.append([301,307])
    connec.append([301,308])
    connec.append([301,314])
    connec.append([302,303])
    connec.append([302,308])
    connec.append([302,309])
    connec.append([302,315])
    connec.append([303,304])
    connec.append([303,309])
    connec.append([303,310])
    connec.append([303,316])
    connec.append([304,305])
    connec.append([304,310])
    connec.append([304,311])
    connec.append([304,317])
    connec.append([305,306])
    connec.append([305,311])
    connec.append([305,312])
    connec.append([305,318])
    connec.append([306,312])
    connec.append([307,308])
    connec.append([307,313])
    connec.append([307,314])
    connec.append([307,320])
    connec.append([308,309])
    connec.append([308,314])
    connec.append([308,315])
    connec.append([308,321])
    connec.append([309,310])
    connec.append([309,315])
    connec.append([309,316])
    connec.append([309,322])
    connec.append([310,311])
    connec.append([310,316])
    connec.append([310,317])
    connec.append([310,323])
    connec.append([311,312])
    connec.append([311,317])
    connec.append([311,318])
    connec.append([311,324])
    connec.append([312,318])
    connec.append([312,319])
    connec.append([312,325])
    connec.append([313,314])
    connec.append([313,320])
    connec.append([313,326])
    connec.append([314,315])
    connec.append([314,320])
    connec.append([314,321])
    connec.append([314,327])
    connec.append([315,316])
    connec.append([315,321])
    connec.append([315,322])
    connec.append([315,328])
    connec.append([316,317])
    connec.append([316,322])
    connec.append([316,323])
    connec.append([316,329])
    connec.append([317,318])
    connec.append([317,323])
    connec.append([317,324])
    connec.append([317,330])
    connec.append([318,319])
    connec.append([318,324])
    connec.append([318,325])
    connec.append([318,331])
    connec.append([319,325])
    connec.append([320,321])
    connec.append([320,326])
    connec.append([320,327])
    connec.append([320,333])
    connec.append([321,322])
    connec.append([321,327])
    connec.append([321,328])
    connec.append([321,334])
    connec.append([322,323])
    connec.append([322,328])
    connec.append([322,329])
    connec.append([322,335])
    connec.append([323,324])
    connec.append([323,329])
    connec.append([323,330])
    connec.append([323,336])
    connec.append([324,325])
    connec.append([324,330])
    connec.append([324,331])
    connec.append([324,337])
    connec.append([325,331])
    connec.append([325,332])
    connec.append([325,338])
    connec.append([326,327])
    connec.append([326,333])
    connec.append([326,339])
    connec.append([327,328])
    connec.append([327,333])
    connec.append([327,334])
    connec.append([327,340])
    connec.append([328,329])
    connec.append([328,334])
    connec.append([328,335])
    connec.append([328,341])
    connec.append([329,330])
    connec.append([329,335])
    connec.append([329,336])
    connec.append([329,342])
    connec.append([330,331])
    connec.append([330,336])
    connec.append([330,337])
    connec.append([330,343])
    connec.append([331,332])
    connec.append([331,337])
    connec.append([331,338])
    connec.append([331,344])
    connec.append([332,338])
    connec.append([333,334])
    connec.append([333,339])
    connec.append([333,340])
    connec.append([333,346])
    connec.append([334,335])
    connec.append([334,340])
    connec.append([334,341])
    connec.append([334,347])
    connec.append([335,336])
    connec.append([335,341])
    connec.append([335,342])
    connec.append([335,348])
    connec.append([336,337])
    connec.append([336,342])
    connec.append([336,343])
    connec.append([336,349])
    connec.append([337,338])
    connec.append([337,343])
    connec.append([337,344])
    connec.append([337,350])
    connec.append([338,344])
    connec.append([338,345])
    connec.append([338,351])
    connec.append([339,340])
    connec.append([339,346])
    connec.append([339,352])
    connec.append([340,341])
    connec.append([340,346])
    connec.append([340,347])
    connec.append([340,353])
    connec.append([341,342])
    connec.append([341,347])
    connec.append([341,348])
    connec.append([341,354])
    connec.append([342,343])
    connec.append([342,348])
    connec.append([342,349])
    connec.append([342,355])
    connec.append([343,344])
    connec.append([343,349])
    connec.append([343,350])
    connec.append([343,356])
    connec.append([344,345])
    connec.append([344,350])
    connec.append([344,351])
    connec.append([344,357])
    connec.append([345,351])
    connec.append([346,347])
    connec.append([346,352])
    connec.append([346,353])
    connec.append([346,359])
    connec.append([347,348])
    connec.append([347,353])
    connec.append([347,354])
    connec.append([347,360])
    connec.append([348,349])
    connec.append([348,354])
    connec.append([348,355])
    connec.append([348,361])
    connec.append([349,350])
    connec.append([349,355])
    connec.append([349,356])
    connec.append([349,362])
    connec.append([350,351])
    connec.append([350,356])
    connec.append([350,357])
    connec.append([350,363])
    connec.append([351,357])
    connec.append([351,358])
    connec.append([351,364])
    connec.append([352,353])
    connec.append([352,359])
    connec.append([352,365])
    connec.append([353,354])
    connec.append([353,359])
    connec.append([353,360])
    connec.append([353,366])
    connec.append([354,355])
    connec.append([354,360])
    connec.append([354,361])
    connec.append([354,367])
    connec.append([355,356])
    connec.append([355,361])
    connec.append([355,362])
    connec.append([355,368])
    connec.append([356,357])
    connec.append([356,362])
    connec.append([356,363])
    connec.append([356,369])
    connec.append([357,358])
    connec.append([357,363])
    connec.append([357,364])
    connec.append([357,370])
    connec.append([358,364])
    connec.append([359,360])
    connec.append([359,365])
    connec.append([359,366])
    connec.append([359,372])
    connec.append([360,361])
    connec.append([360,366])
    connec.append([360,367])
    connec.append([360,373])
    connec.append([361,362])
    connec.append([361,367])
    connec.append([361,368])
    connec.append([361,374])
    connec.append([362,363])
    connec.append([362,368])
    connec.append([362,369])
    connec.append([362,375])
    connec.append([363,364])
    connec.append([363,369])
    connec.append([363,370])
    connec.append([363,376])
    connec.append([364,370])
    connec.append([364,371])
    connec.append([364,377])
    connec.append([365,366])
    connec.append([365,372])
    connec.append([365,378])
    connec.append([366,367])
    connec.append([366,372])
    connec.append([366,373])
    connec.append([366,379])
    connec.append([367,368])
    connec.append([367,373])
    connec.append([367,374])
    connec.append([367,380])
    connec.append([368,369])
    connec.append([368,374])
    connec.append([368,375])
    connec.append([368,381])
    connec.append([369,370])
    connec.append([369,375])
    connec.append([369,376])
    connec.append([369,382])
    connec.append([370,371])
    connec.append([370,376])
    connec.append([370,377])
    connec.append([370,383])
    connec.append([371,377])
    connec.append([372,373])
    connec.append([372,378])
    connec.append([372,379])
    connec.append([372,385])
    connec.append([373,374])
    connec.append([373,379])
    connec.append([373,380])
    connec.append([373,386])
    connec.append([374,375])
    connec.append([374,380])
    connec.append([374,381])
    connec.append([374,387])
    connec.append([375,376])
    connec.append([375,381])
    connec.append([375,382])
    connec.append([375,388])
    connec.append([376,377])
    connec.append([376,382])
    connec.append([376,383])
    connec.append([376,389])
    connec.append([377,383])
    connec.append([377,384])
    connec.append([377,390])
    connec.append([378,379])
    connec.append([378,385])
    connec.append([378,1])
    connec.append([379,380])
    connec.append([379,385])
    connec.append([379,386])
    connec.append([379,2])
    connec.append([380,381])
    connec.append([380,386])
    connec.append([380,387])
    connec.append([380,3])
    connec.append([381,382])
    connec.append([381,387])
    connec.append([381,388])
    connec.append([381,4])
    connec.append([382,383])
    connec.append([382,388])
    connec.append([382,389])
    connec.append([382,5])
    connec.append([383,384])
    connec.append([383,389])
    connec.append([383,390])
    connec.append([383,6])
    connec.append([384,390])
    connec.append([385,386])
    connec.append([385,1])
    connec.append([385,2])
    connec.append([385,8])
    connec.append([386,387])
    connec.append([386,2])
    connec.append([386,3])
    connec.append([386,9])
    connec.append([387,388])
    connec.append([387,3])
    connec.append([387,4])
    connec.append([387,10])
    connec.append([388,389])
    connec.append([388,4])
    connec.append([388,5])
    connec.append([388,11])
    connec.append([389,390])
    connec.append([389,5])
    connec.append([389,6])
    connec.append([389,12])
    connec.append([390,6])
    connec.append([390,7])
    connec.append([390,13])

    
    
    
    connec  = np.array(connec)
#freenode
#Condition of DOF (1=free, 0=fixed)
    freenode = np.ones_like(coord).astype(int)
    
    freenode[18,:]=0
    freenode[19,:]=0
    freenode[20,:]=0
    freenode[57,:]=0
    freenode[58,:]=0
    freenode[59,:]=0
    freenode[96,:]=0
    freenode[97,:]=0
    freenode[98,:]=0
    freenode[135,:]=0
    freenode[136,:]=0
    freenode[137,:]=0
    freenode[174,:]=0
    freenode[175,:]=0
    freenode[176,:]=0
    freenode[213,:]=0
    freenode[214,:]=0
    freenode[215,:]=0
    freenode[252,:]=0
    freenode[253,:]=0
    freenode[254,:]=0
    freenode[291,:]=0
    freenode[292,:]=0
    freenode[293,:]=0
    freenode[330,:]=0
    freenode[331,:]=0
    freenode[332,:]=0
    freenode[369,:]=0
    freenode[370,:]=0
    freenode[371,:]=0
    freenode[408,:]=0
    freenode[409,:]=0
    freenode[410,:]=0
    freenode[447,:]=0
    freenode[448,:]=0
    freenode[449,:]=0
    freenode[486,:]=0
    freenode[487,:]=0
    freenode[488,:]=0
    freenode[525,:]=0
    freenode[526,:]=0
    freenode[527,:]=0
    freenode[564,:]=0
    freenode[565,:]=0
    freenode[566,:]=0
    freenode[603,:]=0
    freenode[604,:]=0
    freenode[605,:]=0
    freenode[642,:]=0
    freenode[643,:]=0
    freenode[644,:]=0
    freenode[681,:]=0
    freenode[682,:]=0
    freenode[683,:]=0
    freenode[720,:]=0
    freenode[721,:]=0
    freenode[722,:]=0
    freenode[759,:]=0
    freenode[760,:]=0
    freenode[761,:]=0
    freenode[798,:]=0
    freenode[799,:]=0
    freenode[800,:]=0
    freenode[837,:]=0
    freenode[838,:]=0
    freenode[839,:]=0
    freenode[876,:]=0
    freenode[877,:]=0
    freenode[878,:]=0
    freenode[915,:]=0
    freenode[916,:]=0
    freenode[917,:]=0
    freenode[954,:]=0
    freenode[955,:]=0
    freenode[956,:]=0
    freenode[993,:]=0
    freenode[994,:]=0
    freenode[995,:]=0
    freenode[1032,:]=0
    freenode[1033,:]=0
    freenode[1034,:]=0
    freenode[1071,:]=0
    freenode[1072,:]=0
    freenode[1073,:]=0
    freenode[1110,:]=0
    freenode[1111,:]=0
    freenode[1112,:]=0
    freenode[1149,:]=0
    freenode[1150,:]=0
    freenode[1151,:]=0

  
#variables
    variables=[2e11, 58000, 100]
#A

    # Material properties
    Mater_Dens = 7850                                                        #kg/m3
    E0 = variables[0]                                                          #N/m 2
    Fy = variables[1]                                                          #*******************
    C_c=(2*E0*math.pi**2/Fy)**0.5
    #print('Cc')
    #print(C_c)
    E = E0 * np.ones(connec.shape[0])
    
    # Define applied force
    F = np.zeros_like(coord)
    #print(F)
    F[:,2] = -variables[2]                                                     #2.248 kips at node 0 to 390

    #print(F[:,2])
    
    # Construct the global K
    n = connec.shape[0] 
    #print(n)
    m = coord.shape[0]
    vectors = coord[connec[:,1],:] - coord[connec[:,0],:]
    l = np.sqrt((vectors**2).sum(axis=1))  # The length of bars

    e = vectors.T/l
    #print(e)
    B = (e[np.newaxis] * e[:,np.newaxis]).T
    #print(B)
    
    #print(A1)
    A22=A1
   
    lamda = [0]*n
    D = [0]*n
    
    radius = [0]*n
    volume=[0]
    for k in range(n) :
          A2 = float(A22[k])
          volume += (A2 * l[k] * Mater_Dens)                                     ###ถูกแล้ว

    D = (E * A22 / l)
    radius = 0.4993*A2**0.6777
    lamda = (1*l/radius)
    Allowable_stress = np.copy(A1)
    XX_stress= np.copy(A1)
    stress_ratio = np.copy(A1)    
    kx = e * D
    #print(kx)
    K = np.zeros((3*m, 3*m))
    
    for i in range(n):  
         aux = 3*connec[i,:]
         # the indies of DOEs
         index = np.r_[aux[0]:aux[0] + 3, aux[1]:aux[1] + 3]
         k0 = np.concatenate((np.concatenate((B[i], -B[i]), axis=1),np.concatenate((-B[i],B[i]), axis=1)), axis=0)
         K[np.ix_(index,index)] = K[np.ix_(index,index)] + D[i] * k0
    #print(k0)
    # Solve KU = F to find the displacement and stress of each element
    block = freenode.flatten().nonzero()[0]
    
    matrix = K[np.ix_(block,block)]
    rhs = F.flatten()[block]
    #solution = spsolve(matrix, rhs)
    solution = np.linalg.inv(matrix).dot(rhs)
    u = freenode.astype(float).flatten()
    u[block] = solution
    U = u.reshape(m,3)
    axial = ((U[connec[:,1],:]-U[connec[:,0],:])*kx.T).sum(axis=1)
    #print(axial)
    stress = (axial / A22)
    #print(stress)
    cost = (U*F).sum()
    dcost = -stress**2 / E *l
    #volume = (A2 * l * Mater_Dens).sum()
    
    # Determine Maximum displacement
    Max_U = abs(U).max(axis=0)

    # Calculate the stress ratio for each element
    for k_k, j_j in enumerate(stress):
        if j_j >= 0:
            Allowable_stress[k_k] = (0.6*Fy)
            XX_stress[k_k]=(stress[k_k])
            stress_ratio[k_k] = (abs(stress[k_k]/Allowable_stress[k_k]))
        else:
            if lamda[k_k] < C_c:
                Allowable_stress[k_k] = (((1-lamda[k_k]**2/(2*C_c**2))*Fy)/(5/3+3*lamda[k_k]/(8*C_c)-lamda[k_k]**3/(8*C_c**3)))
                XX_stress[k_k]=stress[k_k]
                stress_ratio[k_k] = abs(stress[k_k]/Allowable_stress[k_k])
            else:
                Allowable_stress[k_k] = (12*math.pi**2*E[0]/(23*lamda[k_k]**2))
                XX_stress[k_k]=stress[k_k]
                stress_ratio[k_k] = abs(stress[k_k]/(Allowable_stress[k_k]))
                
    X_stress=(abs(XX_stress))
    Al_stress=(abs(Allowable_stress))
            
    Max_stress =max(abs(X_stress/Al_stress))
    
    return volume,Max_U[2], Max_stress #cost, dcost, U, stress, Max_U[2], Max_stress, X_stress, Al_stress, volume

x=[5.35,3.4,26.5938,8.0668,3.6831,2.3176,21.3495,10.3539,6.3859,4.5076,13.8374,10.876,3.0903,5.599,14.2288,9.8232,2.9863,7.6236,8.6671,12.1283,5.1126,6.4542,1.2039,4.2053,2.2692,3.1514,3.9958,7.6868,3.3384,3.4703,4.498,8.4914,6.07,4.7849,4.1645,1.0546,7.2711,4.9319,4.3437,1.0317,6.1891,7.2491,4.8191,1,7.0979,4.3028,1.0716]
a,b,c=Dome1410_Stiffness(x)